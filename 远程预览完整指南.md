# 📱 远程预览完整指南（无需同一 Wi-Fi）

## 🎯 方案总览

我已经为你配置了**三种内网穿透方案**，让你可以在任何地方用 iPhone 预览应用：

1. **Cloudflare Tunnel** ⭐⭐⭐⭐⭐（推荐）
   - ✅ 完全免费
   - ✅ 无需注册账号
   - ✅ 自动安装
   - ✅ 速度较快

2. **ngrok** ⭐⭐⭐⭐
   - ✅ 稳定可靠
   - ⚠️ 需要注册账号（免费版有使用限制）
   - ⚠️ 需要手动安装

3. **自动选择** ⭐⭐⭐⭐⭐
   - ✅ 自动检测可用工具
   - ✅ 优先使用 Cloudflare Tunnel

---

## 🚀 快速开始（推荐方案）

### 方法 1：使用 Cloudflare Tunnel（最简单）

### 步骤 1：启动远程预览

在项目目录打开 PowerShell，运行：

```powershell
npm run dev:cloudflare
```

**首次运行会自动下载 cloudflared，等待 1-2 分钟即可。**

### 步骤 2：获取公网链接

运行后，你会看到类似这样的输出：

```
+----------------------------------------------------------------------------+
|  Your quick Tunnel has been created! Visit it at (it may take some time  |
|  to be reachable):                                                         |
|                                                                             |
|  https://xxxx-xxxx-xxxx.trycloudflare.com                                 |
+----------------------------------------------------------------------------+
```

**复制这个 `https://xxxx.trycloudflare.com` 链接！**

### 步骤 3：在 iPhone 上访问

1. **在任何地方**（无需同一 Wi-Fi）
2. 打开 iPhone Safari 浏览器
3. 输入或粘贴刚才复制的链接
4. 即可访问你的应用！

### 步骤 4：（可选）添加到主屏幕

- Safari → 分享按钮 → "添加到主屏幕"
- 这样可以在主屏幕上像 App 一样打开

---

## 📋 其他方案

### 方法 2：使用 ngrok

#### 安装 ngrok：

1. **下载 ngrok**
   - 访问：https://ngrok.com/download
   - 下载 Windows 版本（ngrok.exe）

2. **安装方式（二选一）**
   
   **方式 A：添加到系统 PATH（推荐）**
   - 解压 ngrok.exe
   - 将 ngrok.exe 所在目录添加到系统 PATH
   - 或直接放在项目根目录

   **方式 B：放在项目目录**
   - 将 ngrok.exe 放在项目根目录 `D:\APP\what-to-eat-today\`

3. **（可选）注册账号获取 authtoken**
   - 访问：https://dashboard.ngrok.com/signup
   - 注册后获取 authtoken
   - 运行：`ngrok config add-authtoken YOUR_TOKEN`
   - 不注册也可以使用，但有使用限制

#### 使用 ngrok：

```powershell
npm run dev:ngrok
```

然后按照输出中的 URL 在 iPhone 上访问。

---

### 方法 3：自动选择（推荐）

```powershell
npm run dev:tunnel
```

这个命令会：
1. 自动检测是否安装了 cloudflared 或 ngrok
2. 优先使用 Cloudflare Tunnel（免费且无需注册）
3. 如果没有，尝试使用 ngrok
4. 自动启动 Vite 开发服务器
5. 自动启动内网穿透

---

## 🎯 完整命令列表

### 开发模式（实时热更新）

```powershell
# 方案 1：自动选择（推荐）
npm run dev:tunnel

# 方案 2：使用 Cloudflare Tunnel（推荐）
npm run dev:cloudflare

# 方案 3：使用 ngrok
npm run dev:ngrok
```

### 预览模式（生产构建）

```powershell
# 构建并启动远程预览
npm run preview:tunnel
```

---

## 📱 在 iPhone 上访问

### 步骤：

1. **获取公网链接**
   - 运行上述命令后，在输出中找到 URL
   - Cloudflare: `https://xxxx.trycloudflare.com`
   - ngrok: `https://xxxx-xx-xx-xx-xx.ngrok-free.app`

2. **在 iPhone Safari 中打开**
   - 直接输入或粘贴 URL
   - 无需任何额外配置

3. **（可选）添加到主屏幕**
   - Safari → 分享 → "添加到主屏幕"
   - 输入名称："今天吃什么"
   - 现在可以在主屏幕像 App 一样打开

---

## ⚙️ 高级配置

### 自定义端口

如果需要使用其他端口，修改脚本中的 `port` 变量：

```javascript
// scripts/start-cloudflare.js 或 start-ngrok.js
const port = 3000; // 改为你想要的端口
```

### 使用固定域名（ngrok 付费版）

如果你有 ngrok 付费账号，可以配置固定域名：

```powershell
ngrok http 5173 --domain=your-domain.ngrok.app
```

---

## 🔧 常见问题

### 问题 1：Cloudflare Tunnel 连接失败

**解决方案：**
- 检查防火墙是否阻止了连接
- 尝试重新运行命令
- 如果持续失败，使用 ngrok 方案

### 问题 2：ngrok 找不到命令

**解决方案：**
- 确认 ngrok.exe 已下载
- 如果放在项目目录，确保文件名是 `ngrok.exe`
- 如果添加到 PATH，在任意目录运行 `ngrok version` 测试

### 问题 3：链接无法访问

**解决方案：**
- 确认开发服务器正在运行（检查终端输出）
- 确认内网穿透工具正在运行
- 尝试重新生成链接（停止后重新运行）

### 问题 4：速度较慢

**说明：**
- 免费的内网穿透服务速度可能不如本地网络
- 这是正常的，主要用于预览功能
- 如果速度太慢，可以考虑：
  - 使用 ngrok 付费版
  - 或使用 Vercel 等云服务部署预览版本

---

## 💡 使用技巧

### 1. 分享链接给他人

你可以将生成的公网链接分享给：
- 团队成员
- 测试用户
- 客户预览

**注意：** 链接只在服务运行期间有效，停止服务后链接会失效。

### 2. 二维码分享

1. 将链接生成二维码（使用在线工具）
2. 在 iPhone 上扫描二维码即可访问

### 3. 保存常用链接

如果使用 ngrok 付费版，可以配置固定域名，这样链接就不会变化。

---

## 🎉 开始使用

**最简单的开始方式：**

```powershell
npm run dev:cloudflare
```

然后：
1. 等待输出中的 URL
2. 在 iPhone Safari 中打开
3. 开始预览！

**就这么简单！** 🚀

---

## 📝 注意事项

1. **安全性**
   - 公网链接是公开的，任何人都可以访问
   - 仅用于开发预览，不要用于生产环境
   - 停止服务后链接会失效

2. **性能**
   - 免费服务可能有速度限制
   - 如果用于正式演示，考虑使用付费服务

3. **稳定性**
   - 免费服务可能偶尔不稳定
   - 如果遇到问题，尝试重新运行命令

---

**现在就可以在任何地方用 iPhone 预览你的应用了！** 📱✨
