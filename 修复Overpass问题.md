# ğŸ”§ ä¿®å¤ Overpass API é—®é¢˜

## âš ï¸ é—®é¢˜

é€‰æ‹©é¤å…æ—¶å‡ºé”™ï¼Œæ§åˆ¶å°æ˜¾ç¤ºï¼š
- `POST https://overpass-api.de/api/interpreter 400 (Bad Request)`
- é”™è¯¯ï¼š`parse error: Unknown type "{"`

**åŸå› åˆ†æï¼š**

1. **ä»£ç å¯èƒ½è¿˜æ²¡æœ‰é‡æ–°éƒ¨ç½²**
   - é”™è¯¯æ˜¾ç¤ºè¿˜åœ¨ç›´æ¥è°ƒç”¨ `overpass-api.de`
   - è¯´æ˜ Vercel ä¸Šçš„ä»£ç å¯èƒ½è¿˜æ˜¯æ—§ç‰ˆæœ¬
   - éœ€è¦é‡æ–°éƒ¨ç½²

2. **ä»£ç†å‡½æ•°æ•°æ®æ ¼å¼å¤„ç†é—®é¢˜**
   - å‰ç«¯å‘é€ï¼š`JSON.stringify({ query: "..." })`
   - ä»£ç†éœ€è¦æå– `query` å­—æ®µä½œä¸ºçº¯æ–‡æœ¬å‘é€ç»™ Overpass API
   - Overpass API éœ€è¦çº¯æ–‡æœ¬ï¼Œä¸æ˜¯ JSON

## âœ… å·²ä¿®å¤

å·²æ›´æ–° `api/overpass.js`ï¼Œç°åœ¨å¯ä»¥æ­£ç¡®å¤„ç†æ•°æ®æ ¼å¼ï¼š
- ä» JSON å¯¹è±¡ä¸­æå– `query` å­—æ®µ
- ä½œä¸ºçº¯æ–‡æœ¬å‘é€ç»™ Overpass API

## ğŸ“¤ éœ€è¦é‡æ–°éƒ¨ç½²

### æ­¥éª¤

1. **æäº¤æ›´æ”¹ï¼ˆä½¿ç”¨ GitHub Desktopï¼‰**

   - æ‰“å¼€ GitHub Desktop
   - åº”è¯¥èƒ½çœ‹åˆ° `api/overpass.js` æ˜¾ç¤ºä¸ºå·²ä¿®æ”¹
   - åœ¨ "Summary (required)" è¾“å…¥ï¼š`Fix: Overpass API proxy data format`
   - ç‚¹å‡» "Commit to main"
   - ç‚¹å‡» "Push origin"

2. **ç­‰å¾… Vercel è‡ªåŠ¨éƒ¨ç½²**

   - è®¿é—®ï¼šhttps://vercel.com/dashboard
   - æ‰¾åˆ°æ‚¨çš„é¡¹ç›®
   - æŸ¥çœ‹éƒ¨ç½²è¿›åº¦
   - ç­‰å¾… 1-2 åˆ†é’Ÿï¼ŒçŠ¶æ€å˜ä¸º "Ready"

3. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶æµ‹è¯•**

   - æŒ‰ `Ctrl + Shift + R`ï¼ˆWindowsï¼‰å¼ºåˆ¶åˆ·æ–°é¡µé¢
   - æˆ–è€…æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
   - æµ‹è¯•é€‰æ‹©é¤å…åŠŸèƒ½
   - åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†

### éªŒè¯

éƒ¨ç½²åï¼Œæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š

1. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - Network æ ‡ç­¾
   - åº”è¯¥çœ‹åˆ°è¯·æ±‚åˆ° `/api/overpass`ï¼ˆä¸æ˜¯ `overpass-api.de`ï¼‰
   - è¯·æ±‚çŠ¶æ€åº”è¯¥æ˜¯ 200

2. **æ£€æŸ¥æ§åˆ¶å°**
   - Console æ ‡ç­¾
   - ä¸åº”è¯¥çœ‹åˆ° CORS é”™è¯¯
   - ä¸åº”è¯¥çœ‹åˆ° 400 Bad Request é”™è¯¯

3. **æµ‹è¯•åŠŸèƒ½**
   - é€‰æ‹© OpenStreetMap
   - é€‰æ‹©ä¸€ä¸ªåœ°ç‚¹
   - é€‰æ‹©é£Ÿç‰©ç±»å‹
   - ç‚¹å‡» "å¸®æˆ‘é€‰"
   - åº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤ºé¤å…åˆ—è¡¨

## ğŸ” æŠ€æœ¯è¯´æ˜

**æ•°æ®æµç¨‹ï¼š**

1. **å‰ç«¯å‘é€ï¼š**
   ```javascript
   fetch('/api/overpass', {
     method: 'POST',
     body: JSON.stringify({ query: "Overpass QL query..." })
   })
   ```

2. **ä»£ç†å‡½æ•°æ¥æ”¶å¹¶å¤„ç†ï¼š**
   ```javascript
   const { query } = req.body  // {query: "Overpass QL query..."}
   const queryString = query.query || query  // æå–å­—ç¬¦ä¸²
   ```

3. **ä»£ç†å‡½æ•°å‘é€ç»™ Overpass APIï¼š**
   ```javascript
   fetch('https://overpass-api.de/api/interpreter', {
     method: 'POST',
     body: queryString  // çº¯æ–‡æœ¬ï¼Œä¸æ˜¯ JSON
   })
   ```

**å…³é”®ç‚¹ï¼š**
- Overpass API éœ€è¦çº¯æ–‡æœ¬çš„ Overpass QL æŸ¥è¯¢è¯­å¥
- ä¸èƒ½å‘é€ JSON æ ¼å¼
- ä»£ç†å‡½æ•°éœ€è¦ä» JSON ä¸­æå–æŸ¥è¯¢å­—ç¬¦ä¸²

---

**é‡è¦ï¼šä¿®å¤åå¿…é¡»é‡æ–°éƒ¨ç½²æ‰èƒ½ç”Ÿæ•ˆï¼**
